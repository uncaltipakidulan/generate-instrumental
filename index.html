<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text to Instrumental Generator</title>
    <!-- Tailwind CSS (untuk styling cepat) -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <!-- Custom CSS Anda -->
    <link rel="stylesheet" href="./style.css">

    <!-- Dependencies untuk html-midi-player: Tone.js dan Magenta.js -->
    <script src="https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/html-midi-player@1.6.0/dist/midi-player.min.js"></script>

    <!-- GANTI INI: Wavesurfer.js dan PLUGINS dari CDN (versi 7.x) -->
    <!-- Ini akan mengatasi error SyntaxError: export declarations... -->
    <script src="https://unpkg.com/wavesurfer.js@7/dist/wavesurfer.min.js"></script>
    <script src="https://unpkg.com/wavesurfer.js@7/dist/plugins/minimap.min.js"></script>
    <script src="https://unpkg.com/wavesurfer.js@7/dist/plugins/timeline.min.js"></script>
    
    <!-- Penting: meta tag CSP harus di awal head, setelah meta charset -->
    <meta http-equiv="Content-Security-Policy" content="
        default-src 'self' data: blob: https://storage.googleapis.com https://dindwwctyp.a.pinggy.link https://uncaltipakidulan.github.io https://unpkg.com;
        script-src 'self' 'unsafe-inline' 'unsafe-eval' https://unpkg.com https://cdn.jsdelivr.net https://storage.googleapis.com blob:;
        connect-src 'self' https://dindwwctyp.a.pinggy.link https://uncaltipakidulan.github.io data: https://storage.googleapis.com https://unpkg.com;
        img-src 'self' data: blob: https://unpkg.com;
        style-src 'self' 'unsafe-inline' https://unpkg.com https://cdn.jsdelivr.net https://storage.googleapis.com;
        font-src 'self' data: https://storage.googleapis.com https://unpkg.com;
        media-src 'self' data: blob: https://storage.googleapis.com https://dindwwctyp.a.pinggy.link https://uncaltipakidulan.github.io;
        worker-src 'self' blob:;
        object-src 'none';
    ">
</head>
<body>
    <!-- Konten Body HTML tetap sama -->
    <!-- Pastikan ada div dengan id="waveform-timeline" dan id="waveform-minimap"
         jika Anda ingin menggunakan plugin timeline dan minimap secara terpisah dari waveform utama.
         Jika tidak, plugin akan menggunakan #waveform container yang sama.
         Saya sarankan untuk menambahkannya untuk layout yang lebih rapi:
    -->
    <div class="bg-white p-8 rounded-lg shadow-lg w-full max-w-lg">
        <!-- ... bagian atas tetap sama ... -->

        <div id="musicOutputDiv" class="hidden mt-4">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Output Instrumental:</h2>
            
            <div id="audioPlayerContainer" class="mb-4">
                <h3 class="text-lg font-semibold text-gray-700 mb-2">Audio Playback:</h3>
                <audio id="audioPlayer" controls class="w-full mb-2"></audio>
                <a id="downloadLink" href="#" download="generated_instrumental.mp3" class="block text-center bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded">
                    Download Audio
                </a>
            </div>
            
            <!-- Perbarui struktur ini untuk Wavesurfer dan plugin-nya -->
            <div id="waveformContainer" class="mb-4">
                <h3 class="text-lg font-semibold text-gray-700 mb-2">Visualisasi Waveform:</h3>
                <div id="waveform" style="width: 100%; height: 120px; border: 1px solid #d1d5db; border-radius: 5px;"></div>
                <!-- Tambah container untuk timeline dan minimap jika ingin terpisah -->
                <div id="waveform-timeline" style="width: 100%; height: 20px; margin-top: 5px;"></div>
                <div id="waveform-minimap" style="width: 100%; height: 40px; margin-top: 5px;"></div>
            </div>

            <!-- ... bagian midiPlayerContainer dan errorDiv tetap sama ... -->
        </div>

        <!-- ... akhir dari div .bg-white ... -->
    </div>

    <!-- Script aplikasi Anda -->
    <script src="./script.js" defer></script>
</body>
</html>
